<!DOCTYPE html><html><head><base href="/"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name="apple-mobile-web-app-title" content=""><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="description" content="David Jones Blog"><meta name="keywords" content="blog,codding,font-end,web,developer,javascript"><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"><link rel="stylesheet" href="styles/bootstrap.css"><title>Welcome | David Jones</title></head><body><header class="header-container"><div class="container"><a class="brand" href="/" title="blog.davidkk.com">dBLog</a><nav class="nav"><a href="/tag/index.html" title="tags">Tags</a><a href="/archive/index.html" title="archive">Archives</a></nav></div></header><div class="article-container container context"><main class="content"><article class="article"><h1 class="article-title">OpenWrt - Goagent</h1><div class="article-infobar"><div class="category"><i class="fa fa-sticky-note-o"></i><a href="/category/OpenWrt/1.html" title="OpenWrt">OpenWrt</a></div><time class="date"><i class="fa fa-calendar-o"></i><span>4/11/2015, 12:57:14</span></time><div class="author">Written by:&nbsp;<a title="&lt;David Jones qowera@qq.com&gt;" target="_blank">&lt;David Jones qowera@qq.com&gt;</a></div></div><section class="article-content"><p>具体 goagent 攻略请自行 google/bing，这里只说明具体 OpenWrt 中安装需注意事项。### 安装 <code>python</code>, <code>python-crypto</code>, <code>pyopenssl</code>, <code>python-openssl```</code>
$ opkg update
$ opkg --dest extdisk install python python-crypto pyopenssl python-openssl
<code>### 安装 gevent因为新版 goagent 需要在 gevent 中运行，应该是3.0+，否则资源消耗巨大。</code>
$ opkg update
$ opkg install gevent python-greenlet
<code>`</code>若在较低版本的 OpenWrt 中并没有这些插件。幸运的话，可以通过网上查找编译好的 gevent 文件，
例如搜索如下文件(此处为 x86 的机器)：- gevent_1.0.1-1_x86.ipk</p>
<ul>
<li>python-greenlet_0.4.5-1_x86.ipk若果没有则首先下载并安装 SDK- <a href="http://wiki.OpenWrt.org/doc/howto/obtain.firmware.sdk">官方WIKI</a>此处编译方式略...### 下载 goagent- <a href="https://github.com/goagent/goagent">goagent in github</a>### 配置 goagent最好放到共享文档中使用编辑器修改，否则会出现很多 ^M<code>$ vim goagent/local/proxy.ini[listen]
ip = 0.0.0.0
port = 8087
...[gae]
appid = app1|app2       # 你自己的 appid，没有？自己google，bing一下
...</code>### PAC文件利用，现在的版本其实可以忽略(还是贴上以前的攻略)利用PAC文件可以实现自动代理。
打开 SwitchyOmega &gt; 设置 &gt; goagent pac &gt; 导出PAC，将导出 goagent.pac 文件上传到路由器 /www 目录中。根据这个文件浏览器就能确定哪些网址需要使用代理，哪些直接连接就可以了。
打开 proxxy.ini 修改，一般新版已经修改好了<code>$ vi /goagent/local/proxxy.ini[pac]
ip = 0.0.0.0
port = 8086</code>将 goagent.pac 放入 proxy.ini 相同目录中，此时 pac 访问地址为
<a href="http://192.168.1.1:8086/goagent.pac###">http://192.168.1.1:8086/goagent.pac###</a> 运行 goagent<code>`</code>
python goagent/local/proxy.py</li>
</ul>
<hr>
<p>GoAgent Version    : 3.2.3 (python/2.7.3 gevent/1.0.1 pyopenssl/0.10)
Listen Address     : 0.0.0.0:8087
GAE Mode           : https (TLSv1)
GAE APPID          : appid1|appid2
Pac Server         : <a href="http://192.168.1.105:8086/proxy.pac">http://192.168.1.105:8086/proxy.pac</a></p>
<h2 id="pac-file-file-mnt-sdb-goagent-local-proxy-pac">Pac File           : file:///mnt/sdb/goagent/local/proxy.pac</h2>
<p>WARNING - [Apr 10 10:25:02] please install <em>libnss3-tools</em> package to import GoAgent root ca
<code>`</code>此处 warning 可以不了他，因为 OpenWrt 并木有一套完整的证书系统。
若浏览器出现 https/ssl 隐私问题，请自行导入 <code>goagent/local/CA.cert</code> 证书，所有选项均信任，证书对于安全的重要性请自行 google/bing。</p>
</section><div class="article-widgets"><div class="tags"><i class="fa fa-tags"></i><a href="/tag/OpenWrt/1.html" title="OpenWrt">OpenWrt</a><a href="/tag/路由器/1.html" title="路由器">路由器</a><a href="/tag/Goagent/1.html" title="Goagent">Goagent</a></div></div></article><nav class="pagination"><ul class="pagination-simple"><li><a href="/article/OpenWrt - 在 Virtualbox 安装 OpenWrt.html" title="OpenWrt - 在 Virtualbox 安装 OpenWrt"><span>Previous</span><span>OpenWrt - 在 Virtualbox 安装 OpenWrt</span></a></li><li><a href="/article/OpenWrt - IPv4 to IPv6.html" title="OpenWrt - IPv4 to IPv6"><span>Next</span><span>OpenWrt - IPv4 to IPv6</span></a></li></ul></nav><div class="comments"><div class="disqus-plugin"><div id="disqus_thread"></div><script>!(function() {
  var d = document;
  s = d.createElement('script');
  s.src = '//davidkk.disqus.com/embed.js';
  s.setAttribute('data-timestamp', +new Date());
  !(d.head || d.body).appendChild(s);
})();</script></div></div></main></div><footer class="footer-container"><div class="container"><div class="about"><a class="link" href="https://github.com/DavidKk" title="Github" target="_blank"><i class="fa fa-github-alt"></i></a><a class="link" href="http://codepen.io/DavidJones" title="CodePen" target="_blank"><i class="fa fa-codepen"></i></a><a class="link" href="https://twitter.com/Mr_DavidJones" title="Twitter" target="_blank"><i class="fa fa-twitter"></i></a><span><i class="fa fa-heart"></i></span><a class="link" href="https://plus.google.com/u/0/111899862347999076942" title="Google Plus" target="_blank"><i class="fa fa-google-plus"></i></a><a class="link" href="http://weibo.com/307853201" title="微博" target="_blank"><i class="fa fa-weibo"></i></a><a class="link" href="mailto:qowera@qq.com" title="E-Mail"><i class="fa fa-envelope-o"></i></a></div><p class="copyright clearfix">Powered by&nbsp;<a href="/">davidkk.com</a>&nbsp;&copy; 2016
,&nbsp;<a href="/static/sitemap.xml" title="Sitemap">Sitemap</a></p></div></footer><script src="scripts/index.js"></script><script id="dsq-count-scr" src="//davidkk.disqus.com/count.js" async></script></body></html>