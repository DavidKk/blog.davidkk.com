<!-- title: aspire 前端开发简述分享与讨论-->
<!-- author: <David Jones qowera@qq.com>-->
<!-- date: 2015-05-08 21:56:34-->
<!-- category: 多人开发-->
<!-- tag: 前端,技术交流-->

# aspire 前端开发简述分享与讨论

#### 首先来一句：前端你们很重要。

## 老掉牙的问题：前后端分离

### 开发流程：

```
            视觉设计 -> 前端开发
交互设计->                        -> 测试/验收-> 迭代
            系统分析 -> 功能开发
```

### 传统MVC开发模式

所谓传统的开发模式，我们web开发通常使用MVC开发模式，用一种业务逻辑、数据、界面显示分离的方法组织代码（具体请自行google, 这里我们主要具体分析前端的问题，后端模块忽略） 。
Controller (控制器) 通过View (视图) 显示页面数据等。这里都是后端人员管理的，因此我们在开发过程中通常会遇到以下问题：

- 模板使用权阻塞：因为共用前端模板，因此前端人员与后端人员要同时修改模板文件的时候，会很容易出现冲突情况。
- 模板逻辑分工不明：某元素是否显示，我们可以通过JS,CSS或模板引擎输出控制，但是模板引擎为后端人员所管理，因此会出现输出逻辑问题。 （这里我们说后端管理输出是因为后端人员在管理控制器，而其中输出的数据均为后端所管理）

总结：

- 前后端依旧高度耦合
  - 前端依赖服务端开发环境
  - 在服务端View层高度耦合
  - 沟通成本高
  - 职责不清晰

- 前端代码越来越复杂
  - 无法统一协作模式，代码充满了约定
  - JS跟CSS，依赖于后端产出的HTML
  - 有的数据来自AJAX，有的数据印在DOM上
  - 有的业务逻辑在前端，有的在Model层，更多的是在View层

### 前后端分离开发模式

因为交互越来越复杂，因此传统开发大大阻碍了前端人员开发超大型复杂程序开发。因此我们提出了前后端分离，增加前端人员开发权重。但是这样大大增加了前端人员的开发量。

因此我们提出了client-side MV*，后端人员把view (视图) 完全交给前端开发人员，即Server/Client 模式。而client-side (客户端) 由完全由前端人员管理。
其中client-side 的开发模式可以是各种各样MV*，业界各种开发模式。而前端开发人员与后端交互仅仅通过数据如JSON数据进行。

优势：

- 关注点分离
- 职责分离(更好的代码维护)
- 对的人做对的事
- 更好的共建模式
- 快速的反应变化(重构)

后端：

- 提供数据
- 处理业务逻辑
- Server-side MVC架构
- 代码跑在服务器上

前端：

- 接收数据，返回数据
- 处理渲染逻辑
- Client-side MV* 架构
- 代码跑在浏览器上

问题：

- 性能问题
  - 渲染，取值都在客户端进行，有性能的问题
  - 需要等待资源到齐才能进行，会有短暂白屏与闪动
  - 在移动设备低速网路的体验奇差无比

- 重用问题
  - 模版无法重用，造成维护上的麻烦与不一致
  - 逻辑无法重用，前端的校验后端仍须在做一次
  - 路由无法重用，前端的路由在后端未必存在

- 跨终端问题
  - 业务太靠前，导致不同端重复实现
  - 逻辑太靠前，造成维护上的不易

- SEO问题
  - 渲染都在客户端，模版无法重用，SEO实现麻烦

### NODEJS 出现

Why nodejs?

- 前端熟悉的语言，学习成本低
- 都是JS，可以前后端复用
- 体质适合：事件驱动、非阻塞I/O
- 适合IO密集型业务
- 执行速度也不差

职责跨分：

```
----------------------------------------------------
      后端                     前端
------------|---------------------------------------
          服务器                       浏览器
--------------------------------|-------------------
   PHP            NodeJS          JS + HTML + CSS
--------------------------------|-------------------
服务层         跑在服务器上的JS       跑在浏览器上的JS
提供数据接口    转发数据，串接服务      CSS、JS加载与运行
维持数据稳定    路由设计，控制逻辑      DOM操作
封装业务逻辑    渲染页面，体验优化      任何的前端框架与工具
              更多的可能             共用模版、路由
----------------------------------------------------
```

## 微商城构架与改造

### 微商城目前架构与问题

前台:
Client: nodejs + grunt + seajs + jquery
Server: nginx + 纯静态项目

后台:
Client: nodejs + grunt + angular
Server: nginx + 纯静态项目

因此我们创建了三个项目分别为:
wmall.cmpower.cn (前台项目)
m.wmall.cmpower.cn (商家后台项目)
api.wmall.cmpower.cn (接口项目)

对于前端来说 nginx 仅仅提供 route 服务，根据路由定向到某一静态文件。
而前端仅仅本机安装了 grunt 实现本地生成静态项目给用户于访问。
```
前端项目结构(两个前端平台都差不多)
node_modules/                     # node 第三方库
client/(or called src)            # 客户端文件夹
  audio/                          # 声音文件
  css/                            # 第三方样式库(如 `bootstrap`)
  fonts/                          # 字体文件
  ico/                            # 图标文件
  images/                         # 图片文件
  jade/
    partials/                     # 局部
    tpls/                         # 模板
    views/                        # 页面
  less/
    components/                   # 组件
    core/                         # 核心
    effects/                      # 效果
    mixins/                       # 混淆
    partials/                     # 局部 (例如 header, footer, nav 那些公用模块)
    resets/                       # 重写
    script-components/            # 含js的组件
    utility/                      # 工具
    variables/                    # 定义的变量
    views/                        # 页面
  scripts/
    app/(or called controllers)   # 页面脚本
    conf/                         # 配置
    helpers/                      # 辅助函数
    libraries/                    # 库(包括第三方)
    models/                       # 模型(主要封装后端调用)
    services/                     # 服务($http等)
    ui/                           # UI
      template/(only in 'm')      # UI模板
    app.js(only in 'wmall')       # 入口文件
  swf/                            # swf 文件
  sprites/                        # 精灵图片
    images/                       # 图片
    tempalte/                     # LESS模板
      sprites.less.mustache
assets/                           # 最终生成的静态文件
views/                            # 最终生成的HTML
```

#### 先来说说遇到并能解决的问题

- 实现了前后端分离(不过还不够，还不够...)
- 解决了前端因为纯静态造成的缓存问题
- 所有静态文件都分模块管理

#### 再来说我们需要优化或没有解决的问题
- 多人开发造成不必要的冲突

### 微商城前端优化方案

### 最后
文档太多，我不想写...

## 介绍一下 webMSPA-seed 种子项目


## 活动前端架构优化方案

我们使用 CodeIgnitor 框架进行开发，因此我们的项目结构一般为：

```
branches/
  application/
  system/
  static/ (前端们就靠这个混两顿饭吃，%>_<%)
```

#### 本人认为最有解决方案

## Angular 简单介绍

<!-- ## 前端规范

## RESTful

## Git

## 建议 -->